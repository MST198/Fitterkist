<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8" />
<title>Fitterskist App</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<style>
html, body {margin:0; padding:0; height:100%; background:#3f888f; font-family: Arial,sans-serif; color:#002626;}
#pwlock {position:fixed;top:0;left:0;right:0;bottom:0;background:#3f888f;display:flex;align-items:center;justify-content:center;z-index:10000;}
#pwbox {background:rgba(255,255,255,0.13);border-radius:22px;padding:42px 24px 36px 24px;width:390px;max-width:98vw;box-shadow:0 6px 32px #23515155;text-align:center;}
#pwbox svg {max-width:260px;width:99vw;margin:auto;margin-bottom:38px;display:block;}
#pwbox label {color:white;font-weight:bold;font-size:1.28em;margin-bottom:14px;display:block;}
#pwbox input {width:160px;font-size:1.23em;border-radius:7px;padding:10px 8px;border:1.5px solid #21969d;text-align:center;outline:none;letter-spacing:0.17em;}
#pwbox input:focus {border-color:#e7bb41;}
#pwbox button {margin-top:18px;width:120px;font-weight:bold;font-size:1.2em;background:#e7bb41;border-radius:7px;color:#293a33;border:none;padding:10px 0;cursor:pointer;box-shadow:0 2px 10px #0002;}
#pwbox button:hover {background:#fffbe7;color:#0a282d;}
#pwerror {margin-top:15px;color:#c33;font-weight:bold;display:none;}
.hide {display:none !important;}
header {background:#002626;color:#e7bb41;padding:15px 0 15px 0;text-align:center;position:relative;font-weight:bold;font-size:1.22em;}
.menu-btn {position:absolute;right:20px;top:14px;background:none;border:none;color:#e7bb41;font-size:2em;cursor:pointer;padding:0;user-select:none;}
.menu-panel {display:none;position:fixed;top:0;right:0;width:200px;background:#fff;border-radius:0 0 0 13px;box-shadow:-2px 3px 16px rgba(0,0,0,0.3);z-index:9999;}
.menu-panel ul {list-style:none;margin:0;padding:0;}
.menu-panel li {border-bottom:1px solid #eee;}
.menu-panel li:last-child {border-bottom:none;}
.menu-panel button {width:100%;text-align:left;background:none;border:none;font-size:1.1em;color:#222;padding:15px 20px;cursor:pointer;}
.menu-panel button:hover {background:#e7bb41;color:#002626;}
.menu-panel .closebtn {text-align:right;font-size:1.5em;background:none;border:none;color:#999;padding:10px 15px 10px 0;cursor:pointer;}
.container {max-width:900px;margin:1rem auto;padding:8px;background:#d3d0cb;border-radius:8px;}
label{font-weight:bold;display:block;margin-bottom:5px;}
input[type=text],input[type=number]{width:300px;max-width:100%;padding:8px;border-radius:4px;border:1px solid #ccc;margin-bottom:12px;font-size:1rem;}
button,button.start-btn{background:#3f888f;color:#fff;font-size:1rem;border:none;border-radius:5px;padding:10px 14px;cursor:pointer;transition:background 0.25s;margin:5px 0;user-select:none;}
button.start-btn{background:#002626;font-weight:bold;font-size:1.11rem;padding:13px 20px;}
button:hover{background:#e7bb41;color:#002626;}
button.start-btn:hover{background:#e7bb41;color:#002626;}
.art-list{display:flex;flex-direction:column;gap:8px;}
.art-card{display:flex;align-items:center;background:#fff;border-radius:6px;padding:8px;box-shadow:0 1px 2px rgba(0,38,38,0.1);min-height:60px;}
.art-img{width:32px;height:32px;font-size:1.3em;display:flex;justify-content:center;align-items:center;background:#e7e5df;border-radius:5px;border:1px solid #e7bb41;flex-shrink:0;margin-left:12px;}
.art-info{flex:1;padding-right:12px;}
.art-info h4{margin:0 0 3px 0;font-size:1.05rem;line-height:1.25;}
.art-info .details{font-size:0.8rem;color:#555;line-height:1.2;}
.art-actions{display:flex;align-items:center;gap:6px;margin-right:12px;}
.art-actions input{width:48px;font-size:0.95rem;padding:4px 6px;text-align:center;border-radius:4px;border:1px solid #ccc;}
.art-actions button{padding:4px 10px;font-size:1rem;min-width:28px;}
table{width:100%;border-collapse:collapse;margin-top:12px;background:#fff;font-size:0.9rem;}
th,td{border:1px solid #ddd;padding:6px 8px;text-align:left;}
th{background:#3f888f;color:#fff;font-weight:bold;font-size:0.85rem;}
tfoot td{font-weight:bold;background:#e7bb41;}
td.mistcell{background:#ffeaea !important;color:#c33 !important;font-weight:bold;}
.overzicht-buttons{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:16px;}
.overzicht-buttons button{flex:1;min-width:150px;max-width:220px;}
.status-info{background:#e7bb41;color:#002626;padding:10px;border-radius:6px;margin-bottom:12px;text-align:center;font-weight:600;}
@media (max-width:600px){body,html{font-size:14px;}header h1{font-size:1.1rem;}.menu-btn{font-size:1.8rem;width:34px;height:34px;}.art-card{flex-direction:column;align-items:flex-start;}.art-actions{margin:10px 0 0 0;justify-content:flex-start;}.art-actions input{width:40px;}input[type=text],input[type=number]{width:100%;}.menu-panel{width:90vw;max-width:280px;} .container{padding:5px;}#pwbox{width:98vw;}#pwbox svg{max-width:89vw;}}
</style>
</head>
<body>

<!-- Wachtwoordscherm -->
<div id="pwlock">
  <div id="pwbox" role="dialog" aria-modal="true">
    <svg aria-hidden="true" focusable="false" viewBox="0 0 500 210">
      <rect x="50" y="75" width="400" height="110" rx="26" fill="#383c43" stroke="#222" stroke-width="5"/>
      <rect x="70" y="44" width="360" height="48" rx="14" fill="#24282e" stroke="#191a1c" stroke-width="2.8"/>
      <rect x="70" y="119" width="50" height="28" rx="9" fill="#e7bb41" stroke="#b89d2f" stroke-width="3.5"/>
      <rect x="380" y="119" width="50" height="28" rx="9" fill="#e7bb41" stroke="#b89d2f" stroke-width="3.5"/>
      <ellipse cx="250" cy="200" rx="185" ry="14.5" fill="#23515155"/>
      <rect x="70" y="89" width="360" height="7.7" fill="#bfc9d1"/>
      <rect x="204" y="122" width="92" height="37" rx="8" fill="#e7bb41"/>
      <text x="250" y="149" font-size="32" fill="#2b2b1a" font-family="Arial" text-anchor="middle" font-weight="bold" letter-spacing="4.6">STANLEY</text>
    </svg>
    <label for="pwinput">Voer wachtwoord in</label>
    <input type="password" id="pwinput" placeholder="Wachtwoord" autocomplete="off" />
    <button type="button" onclick="checkpw()">Login</button>
    <div id="pwerror" role="alert" aria-live="assertive">Fout wachtwoord</div>
  </div>
</div>

<header>
  Gereedschapskist Inventarisatie
  <button title="Menu" aria-label="Menu openen" class="menu-btn" onclick="toggleMenu()">‚ò∞</button>
</header>
<nav id="menu-panel" class="menu-panel" aria-label="menu">
  <button class="closebtn" aria-label="Sluiten" onclick="closeMenu()">&times;</button>
  <ul>
    <li><button onclick="resetAlles()"><strong>üîÑ Reset (start opnieuw)</strong></button></li>
    <li><button onclick="openPaneel('inventarisatie')">üìù Tellen</button></li>
    <li><button onclick="openPaneel('overzicht')">üìä Overzicht</button></li>
  </ul>
</nav>

<div class="container">

  <!-- Beginpaneel: klant/kist/hoeveelheid invullen -->
  <div id="start-paneel" class="panel hide">
    <label for="klantnaam">Klantnaam:</label>
    <input type="text" id="klantnaam" placeholder="Bedrijfsnaam of klant..." />
    <label for="kistnums">Kistnummer(s):</label>
    <input type="text" id="kistnums" placeholder="101, 102 of 101 102..." />
    <small style="color:#444;display:block; margin-bottom:12px;">Meerdere nummers gescheiden door komma of spatie</small>
    <label for="kistcount">Hoeveel kisten tellen?</label>
    <input type="number" id="kistcount" min="1" value="1" />
    <button class="start-btn" onclick="startInventarisatie()">üöÄ Start telling</button>
    <hr />
    <button onclick="document.getElementById('importfile').click()">üìÅ Herstel van bestand</button>
    <input type="file" id="importfile" style="display:none" accept=".json" />
    <small style="color:#444; display:block; margin-top:6px;">Zoek een bestand als: <b>Fitterskist YYMMDD.json</b></small>
  </div>

  <div id="inventarisatie-paneel" class="panel hide">
    <div><b>Klant:</b> <span id="klantnaam-out"></span> | <b>Kist(en):</b> <span id="kistnums-out"></span> | <b>Aantal:</b> <span id="aantal-kisten"></span></div>
    <div id="art-list" class="art-list"></div>
    <button onclick="openPaneel('start')">‚¨ÖÔ∏è Terug</button>
  </div>

  <div id="overzicht-paneel" class="panel hide">
    <div><b>Klant:</b> <span id="klantnaam-ovz"></span> | <b>Kist(en):</b> <span id="kistnums-ovz"></span></div>
    <div class="overzicht-buttons">
      <button onclick="maakVermissingslijst()">üìã Maak vermissingslijst</button>
      <button onclick="downloadCSV()" id="csv-btn" style="display:none;">üìÑ Download CSV</button>
      <button onclick="emailLeverancier()" id="lev-btn" style="display:none;">üìß Mail leverancier</button>
      <button onclick="emailKlant()" id="klant-btn" style="display:none;">üíº Mail klant</button>
      <button onclick="printLijst()" id="print-btn" style="display:none;">üñ®Ô∏è Print</button>
    </div>
    <div id="vermissingslijst-sectie" style="display:none;">
      <h3>üõí Vermissingslijst</h3>
      <div id="status-info" class="status-info"></div>
      <div id="lijst-tabel"></div>
    </div>
    <button onclick="openPaneel('start')" style="margin-top:10px;">‚¨ÖÔ∏è Terug</button>
  </div>
</div>

<div id="flashmsg" style="display:none;position:fixed;right:30px;top:80px;z-index:999;background:#3bb273;color:#fff;padding:9px 16px;border-radius:7px;font-weight:bold;box-shadow:0 2px 6px #2228;"></div>

<script>
/* --- ARTIKELEN --- */
const artikelen = [
  {leverancier_nr:"2486607", ons_nr:"11675001", naam:"Gereedschapkist Fatmax", prijs:54.84, img:"üß∞"},
  {leverancier_nr:"4130507", ons_nr:"11675002", naam:"M-LOY Hangslot 40MM", prijs:8.16, img:"üîê"},
  {leverancier_nr:"2399308", ons_nr:"11675003", naam:"Metaal beugelzaag 300mm", prijs:18.91, img:"ü™ö"},
  {leverancier_nr:"2399306", ons_nr:"11675004", naam:"Zaagblad metaal 300mm", prijs:1.61, img:"‚öôÔ∏è"},
  {leverancier_nr:"2117581", ons_nr:"11675005", naam:"1716P schraper", prijs:14.18, img:"üî™"},
  {leverancier_nr:"6692052", ons_nr:"11675006", naam:"Sleufplaatbeitel", prijs:14.31, img:"ü™õ"},
  {leverancier_nr:"11807240", ons_nr:"11675007", naam:"Gasfles sleutel", prijs:9.26, img:"üóùÔ∏è"},
  {leverancier_nr:"2477111", ons_nr:"11675008", naam:"Centerpons 120mm", prijs:2.79, img:"üìç"},
  {leverancier_nr:"2477107", ons_nr:"11675009", naam:"Koudbeitel 200mm", prijs:6.91, img:"üìå"},
  {leverancier_nr:"4696786", ons_nr:"11675010", naam:"Kraspen Elzet", prijs:4.77, img:"üñãÔ∏è"},
  {leverancier_nr:"2448116", ons_nr:"11675011", naam:"Pijptang 310mm", prijs:20.53, img:"‚≠ï"},
  {leverancier_nr:"2396764", ons_nr:"11675012", naam:"Moersleutel zwart 300mm", prijs:19.41, img:"üî©"},
  {leverancier_nr:"3046217", ons_nr:"11675013", naam:"Metaalvijl rond 250mm", prijs:4.13, img:"üó°Ô∏è"},
  {leverancier_nr:"3046216", ons_nr:"11675014", naam:"Metaalvijl halfrond 250mm", prijs:4.95, img:"üó°Ô∏è"},
  {leverancier_nr:"10021954", ons_nr:"11675015", naam:"Waterpomp tang 250mm", prijs:14.04, img:"üíß"},
  {leverancier_nr:"2300751", ons_nr:"11675016", naam:"Ring-steeksleutel 10mm", prijs:2.81, img:"üîß"},
  {leverancier_nr:"2300746", ons_nr:"11675017", naam:"Ring-steeksleutel 13mm", prijs:3.33, img:"üîß"},
  {leverancier_nr:"2300747", ons_nr:"11675018", naam:"Ring-steeksleutel 17mm", prijs:4.43, img:"üîß"},
  {leverancier_nr:"2300745", ons_nr:"11675019", naam:"Ring-steeksleutel 19mm", prijs:5.00, img:"üîß"},
  {leverancier_nr:"2300737", ons_nr:"11675020", naam:"Ring-steeksleutel 22mm", prijs:6.60, img:"üîß"},
  {leverancier_nr:"2300738", ons_nr:"11675021", naam:"Ring-steeksleutel 24mm", prijs:7.54, img:"üîß"},
  {leverancier_nr:"2300735", ons_nr:"11675022", naam:"Ring-steeksleutel 27mm", prijs:9.89, img:"üîß"},
  {leverancier_nr:"2300740", ons_nr:"11675023", naam:"Ring-steeksleutel 30mm", prijs:11.55, img:"üîß"},
  {leverancier_nr:"2300739", ons_nr:"11675024", naam:"Ring-steeksleutel 32mm", prijs:13.41, img:"üîß"},
  {leverancier_nr:"2477115", ons_nr:"11675025", naam:"Breekijzer 400mm", prijs:12.95, img:"‚öíÔ∏è"},
  {leverancier_nr:"188715", ons_nr:"11675026", naam:"Wig 2,0 KG", prijs:22.24, img:"üî∫"},
  {leverancier_nr:"5448459", ons_nr:"11675027", naam:"Rolbandmaat 5m", prijs:4.23, img:"üö∞"},
  {leverancier_nr:"2447236", ons_nr:"11675028", naam:"Aluminium waterpas 400mm", prijs:18.75, img:"üìè"},
  {leverancier_nr:"666901", ons_nr:"11675029", naam:"Plaatwinkelhaak 300mm", prijs:14.63, img:"üìê"},
  {leverancier_nr:"2269601", ons_nr:"11675030", naam:"bankhamer 1000gram", prijs:18.38, img:"üî®"},
  {leverancier_nr:"7425836", ons_nr:"11675031", naam:"Bankhamer 2000gram", prijs:30.93, img:"üî®"},
  {leverancier_nr:"5812679", ons_nr:"11675032", naam:"Vuisthamer 1500gram", prijs:18.86, img:"üî®"},
  {leverancier_nr:"593999", ons_nr:"11675033", naam:"schroevendraaier softfinish", prijs:18.46, img:"ü™õ"},
  {leverancier_nr:"850077", ons_nr:"11675034", naam:"Staalborstel 3 rij", prijs:2.45, img:"üöø"}
]; artikelen.forEach(a=>a.standaard=1);

let aantallen = [];
let huidigeVermissingen = [];
const PW = "1808";

/* --- LOGIN EN PANELS --- */
function checkpw() {
  var val = document.getElementById('pwinput').value.trim();
  if (val === PW) {
    localStorage.setItem('authed', '1');
    document.getElementById('pwlock').style.display = 'none';
    openPaneel('start');
  } else {
    var err = document.getElementById('pwerror');
    err.style.display = 'block';
    setTimeout(() => err.style.display = 'none', 1700);
    document.getElementById('pwinput').value = '';
    document.getElementById('pwinput').focus();
  }
}
document.getElementById('pwinput').addEventListener('keydown', function(e){
  if (e.key === 'Enter') checkpw();
});
window.addEventListener('DOMContentLoaded', function(){
  if (localStorage.getItem('authed') === '1') {
    document.getElementById('pwlock').style.display = 'none';
    openPaneel(localStorage.getItem('lastpaneel')||'start');
  } else {
    document.getElementById('pwlock').style.display = 'flex';
    document.getElementById('pwinput').focus();
  }
});

function openPaneel(paneel){
  document.querySelectorAll('.panel').forEach(el => el.classList.add('hide'));
  document.getElementById(paneel+'-paneel').classList.remove('hide');
  localStorage.setItem('lastpaneel', paneel);
  if(paneel==='inventarisatie'){ buildArtikellijst(); updateKlantBalk(); }
  if(paneel==='overzicht'){ updateKlantBalk(); }
  if(paneel==='start'){ loadStartData(); }
}

/* --- RESET: login status blijft, rest wordt gewist, terug naar start-paneel --- */
function resetAlles() {
  Object.keys(localStorage).forEach(k=>{
    if(k!=='authed') localStorage.removeItem(k)
  });
  openPaneel('start');
  document.getElementById('klantnaam').value = '';
  document.getElementById('kistnums').value = '';
  document.getElementById('kistcount').value = '1';
}

/* --- MENU --- */
function toggleMenu() {
  const menu = document.getElementById('menu-panel');
  menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
}
function closeMenu() {
  document.getElementById('menu-panel').style.display = 'none';
}
/* --- DATA --- */
function startInventarisatie(){
  localStorage.setItem('klantnaam', document.getElementById('klantnaam').value||'');
  localStorage.setItem('kistnums', document.getElementById('kistnums').value||'');
  localStorage.setItem('kistcount', document.getElementById('kistcount').value||'1');
  // Lege tellingen klaarzetten
  aantallen = artikelen.map(()=>0);
  localStorage.setItem('aantallen', JSON.stringify(aantallen));
  openPaneel('inventarisatie');
}
function buildArtikellijst(){
  const kl = document.getElementById('art-list');
  kl.innerHTML = '';
  aantallen = JSON.parse(localStorage.getItem('aantallen')||'[]');
  if(aantallen.length!==artikelen.length) aantallen = artikelen.map(()=>0);
  artikelen.forEach((art, i) => {
    const moet = art.standaard*(parseInt(localStorage.getItem('kistcount'))||1);
    const el = document.createElement('div');
    el.className = 'art-card';
    el.innerHTML = `
      <div class="art-info">
        <h4>${art.naam}</h4>
        <div class="details">Art. nr: ${art.ons_nr}<br>Per kist: ${art.standaard} | Totaal: ${moet}</div>
      </div>
      <div class="art-actions">
        <button onclick="veranderAantal(${i},-1)">-</button>
        <input type="number" min="0" value="${aantallen[i]||0}" id="a${i}" onchange="updateAantal(${i},this)">
        <button onclick="veranderAantal(${i},1)">+</button>
      </div>
      <div class="art-img">${art.img}</div>
      `;
      kl.appendChild(el);
  });
}
function veranderAantal(i,d){
  aantallen[i]=Math.max(0,(aantallen[i]||0)+d);
  document.getElementById('a'+i).value = aantallen[i];
  localStorage.setItem('aantallen', JSON.stringify(aantallen));
}
function updateAantal(i,el){
  aantallen[i]=Math.max(0,parseInt(el.value)||0);
  localStorage.setItem('aantallen', JSON.stringify(aantallen));
}
function updateKlantBalk(){
  document.getElementById('klantnaam-out')&&(document.getElementById('klantnaam-out').textContent=localStorage.getItem('klantnaam')||'');
  document.getElementById('kistnums-out')&&(document.getElementById('kistnums-out').textContent=localStorage.getItem('kistnums')||'');
  document.getElementById('aantal-kisten')&&(document.getElementById('aantal-kisten').textContent=localStorage.getItem('kistcount')||'');
  document.getElementById('klantnaam-ovz')&&(document.getElementById('klantnaam-ovz').textContent=localStorage.getItem('klantnaam')||'');
  document.getElementById('kistnums-ovz')&&(document.getElementById('kistnums-ovz').textContent=localStorage.getItem('kistnums')||'');
}
function loadStartData(){
  document.getElementById('klantnaam').value = localStorage.getItem('klantnaam')||'';
  document.getElementById('kistnums').value = localStorage.getItem('kistnums')||'';
  document.getElementById('kistcount').value = localStorage.getItem('kistcount')||'1';
}

/* Overzicht, mail, backup enz kan je hieronder verder toevoegen (volgens jouw bestand) */
function maakVermissingslijst(){}
function downloadCSV(){}
function emailLeverancier(){}
function emailKlant(){}
function printLijst(){}
document.getElementById('importfile').addEventListener('change', function(e) {});
</script>
</body>
</html>
